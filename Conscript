#!/usr/local/bin/perl
# Copyright (c) 2000-2006 ActiveState Software Inc.
# See the file LICENSE.txt for licensing information.


Import(
    'cons',
    'build',
    'platform',
    'productType',
    'buildFlavour',
    'buildType',
    'unsiloedPythonExe',
    'ranRegxpcomStateFileName',
    'mozComponentsDir',
    'mozIdlIncludePath',
    'idlExportDir',
    'supportDir',
    'komodoPythonUtilsDir',
    'mozVersion',
    'sdkDir',
);

$cons->InstallPythonUtility('styles.py');
$cons->Preprocess('factoryStyleSettings.unprocessed.py',
                  'factoryStyleSettings.py');
$cons->InstallPythonUtility('factoryStyleSettings.py');
$cons->InstallPythonUtility('userStyleSettings.py');
$cons->Install($idlExportDir, 'koIScintillaSchemeService.idl');
$cons->BuildAndInstallXpt('koIScintillaSchemeService.idl');
$cons->Preprocess('koScintillaSchemeService.unprocessed.py',
                  'koScintillaSchemeService.py');
$cons->InstallXpcomComponent('koScintillaSchemeService.py');
$cons->Preprocess('Default.unprocessed.ksf', 'Default.ksf');
$cons->Install("$supportDir/schemes", 'Default.ksf');
$cons->Preprocess('Dark.unprocessed.ksf', 'Dark.ksf');
$cons->Install("$supportDir/schemes", 'Dark.ksf');
$cons->Preprocess('Medium.unprocessed.ksf', 'Medium.ksf');
$cons->Install("$supportDir/schemes", 'Medium.ksf');
$cons->Preprocess('Bright.unprocessed.ksf', 'Bright.ksf');
$cons->Install("$supportDir/schemes", 'Bright.ksf');

$cons->BuildAndInstallXpt('koIKeybindingSchemeService.idl');
$cons->InstallXpcomComponent('koKeybindingSchemeService.py');
if ($platform eq "darwin") {
    $cons->Preprocess('Default.unprocessed.kkf', 'Windows.kkf');
    $cons->Install("$supportDir/schemes", 'Windows.kkf');
    $cons->Preprocess('Mac.unprocessed.kkf', 'Default.kkf');
    $cons->Install("$supportDir/schemes", 'Default.kkf');
} else {
    $cons->Preprocess('Default.unprocessed.kkf', 'Default.kkf');
    $cons->Install("$supportDir/schemes", 'Default.kkf');
}
$cons->Preprocess('Emacs.unprocessed.kkf', 'Emacs.kkf');
$cons->Install("$supportDir/schemes", 'Emacs.kkf');

$cons->BuildAndInstallXpt('koIViCommandDetail.idl');
$cons->InstallXpcomComponent('koViCommandDetail.py');

$cons->Preprocess("_vi.p.kkf", "_vi.kkf");
$cons->Install("$supportDir/schemes", '_vi.kkf');
$cons->Depends("_vi.kkf", "Default.kkf");

$cons->Preprocess("Vi.p.kkf", "Vi.kkf");
$cons->Install("$supportDir/schemes", 'Vi.kkf');
$cons->Depends("Vi.kkf", "_vi.kkf");
